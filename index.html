<!DOCTYPE html>
<html>
  <head>
    <title>Login</title>
  </head>
  <body>
    <h2>Login</h2>
    <form id="loginForm">
      <input type="text" id="username" placeholder="Username" required /><br />
      <input
        type="password"
        id="password"
        placeholder="Password"
        required
      /><br />
      <button type="submit">Login</button>
    </form>
    <p id="result"></p>

    <script>
      document
        .getElementById("loginForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const username = document.getElementById("username").value;
          const password = document.getElementById("password").value;

          fetch(
            "https://script.google.com/macros/s/AKfycbyqnpyf6oRx7SAeU2zaCxL2Cw73FJ-zag07cV2j8JItoeO0sYULDiryshW20ZqbujyYEw/exec",
            {
              method: "POST",
              body: JSON.stringify({ username, password }),
              headers: { "Content-Type": "application/json" },
            }
          )
            .then((res) => res.json())
            .then((data) => {
              if (data.success) {
                // Simpan username dan role ke localStorage
                localStorage.setItem("username", username);
                localStorage.setItem("role", data.role);

                // Redirect ke home.html
                window.location.href = "home.html";
              } else {
                document.getElementById("result").innerText =
                  "Login gagal. Username atau password salah.";
              }
            })
            .catch((err) => {
              document.getElementById("result").innerText =
                "Terjadi error saat login.";
              console.error("Error:", err);
              console.error(err);
            });
        });
    </script>
  </body>
</html>
